# âœ… äº‘æ•°æ®åº“é…ç½®å®Œæˆ

## ğŸ“Š é…ç½®ä¿¡æ¯

### äº‘æ•°æ®åº“è¿æ¥ä¿¡æ¯
```
ä¸»æœºåœ°å€: 82.157.154.143
ç«¯å£: 5432
æ•°æ®åº“å: agri
ç”¨æˆ·å: agri_root
å¯†ç : agri_root
```

### æœåŠ¡é…ç½®
```
æœåŠ¡ç«¯å£: 3003
APIå‰ç¼€: /api/community
```

## ğŸ¯ å·²å®Œæˆçš„å·¥ä½œ

### âœ… 1. æ•°æ®åº“é©±åŠ¨è¿ç§»
- âŒ ç§»é™¤ MySQL (mysql2)
- âœ… å®‰è£… PostgreSQL (pg ^8.11.3)

### âœ… 2. é…ç½®æ–‡ä»¶æ›´æ–°
- âœ… `.env` - äº‘æ•°æ®åº“è¿æ¥é…ç½®
- âœ… `.env.example` - ç¤ºä¾‹é…ç½®
- âœ… `config/database.js` - PostgreSQL è¿æ¥æ± 

### âœ… 3. æ§åˆ¶å™¨æ›´æ–°ï¼ˆå…¨éƒ¨é‡å†™ï¼‰
- âœ… `followController.js` - 6ä¸ªæ–¹æ³•
- âœ… `categoryController.js` - 2ä¸ªæ–¹æ³•
- âœ… `contentController.js` - 8ä¸ªæ–¹æ³•
- âœ… `reportController.js` - 3ä¸ªæ–¹æ³•
- âœ… `qaController.js` - 2ä¸ªæ–¹æ³•

### âœ… 4. æ•°æ®åº“è„šæœ¬
- âœ… `database-schema-postgres.sql` - PostgreSQL å»ºè¡¨è„šæœ¬
  - 12å¼ è¡¨å®Œæ•´å®šä¹‰
  - ç´¢å¼•å’Œçº¦æŸ
  - è§¦å‘å™¨å‡½æ•°
  - ç¤ºä¾‹æ•°æ®

### âœ… 5. æ–‡æ¡£æ›´æ–°
- âœ… `README.md` - ä¸»æ–‡æ¡£
- âœ… `QUICK-START.md` - å¿«é€Ÿå¯åŠ¨
- âœ… `DEPENDENCIES.md` - ä¾èµ–è¯´æ˜
- âœ… `CLOUD-DATABASE-SETUP.md` - äº‘æ•°æ®åº“ä¸“ç”¨æŒ‡å—
- âœ… `POSTGRESQL-SETUP.md` - PostgreSQL è®¾ç½®
- âœ… `POSTGRESQL-MIGRATION.md` - è¿ç§»æŒ‡å—
- âœ… `START-HERE.md` - å¯åŠ¨æŒ‡å—
- âœ… `äº‘æ•°æ®åº“é…ç½®å®Œæˆ.md` - æœ¬æ–‡æ¡£

### âœ… 6. æµ‹è¯•å·¥å…·
- âœ… `test-connection.js` - æ•°æ®åº“è¿æ¥æµ‹è¯•è„šæœ¬
- âœ… `npm run test:db` - æµ‹è¯•å‘½ä»¤

## ğŸš€ å¿«é€Ÿå¯åŠ¨ï¼ˆ3æ­¥ï¼‰

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–
```bash
cd backend/community
npm install
```

### æ­¥éª¤ 2: æµ‹è¯•è¿æ¥
```bash
npm run test:db
```

### æ­¥éª¤ 3: å¯åŠ¨æœåŠ¡
```bash
npm run dev
```

## ğŸ“ ä¸»è¦è¯­æ³•å˜æ›´

| åŠŸèƒ½ | MySQL | PostgreSQL |
|------|-------|-----------|
| å‚æ•°å ä½ç¬¦ | `?` | `$1, $2, $3` |
| æŸ¥è¯¢ç»“æœ | `[rows]` | `result.rows` |
| æ’å…¥è¿”å›ID | `result.insertId` | `RETURNING id` |
| å½±å“è¡Œæ•° | `affectedRows` | `rowCount` |
| è¿æ¥è·å– | `getConnection()` | `connect()` |
| äº‹åŠ¡å¼€å§‹ | `beginTransaction()` | `query('BEGIN')` |
| æ¨¡ç³ŠæŸ¥è¯¢ | `LIKE` | `ILIKE` |

## ğŸ“¦ ä¾èµ–æ¸…å•

### ç”Ÿäº§ä¾èµ–
```json
{
  "express": "^4.18.2",
  "pg": "^8.11.3",
  "jsonwebtoken": "^9.0.2",
  "dotenv": "^16.3.1",
  "cors": "^2.8.5"
}
```

### å¼€å‘ä¾èµ–
```json
{
  "nodemon": "^3.0.2"
}
```

## ğŸ—„ï¸ æ•°æ®åº“è¡¨ï¼ˆ12å¼ ï¼‰

1. âœ… `community_follows` - å…³æ³¨å…³ç³»è¡¨
2. âœ… `community_blacklist` - é»‘åå•è¡¨
3. âœ… `community_categories` - å†…å®¹åˆ†ç±»è¡¨
4. âœ… `community_tags` - æ ‡ç­¾è¡¨
5. âœ… `community_content` - å†…å®¹ä¸»è¡¨
6. âœ… `community_content_tags` - å†…å®¹æ ‡ç­¾å…³è”è¡¨
7. âœ… `community_comments` - è¯„è®ºè¡¨
8. âœ… `community_likes` - ç‚¹èµè¡¨
9. âœ… `community_collects` - æ”¶è—è¡¨
10. âœ… `community_reports` - ä¸¾æŠ¥è¡¨
11. âœ… `community_violations` - è¿è§„è®°å½•è¡¨
12. âœ… `community_qa_relation` - é—®ç­”å…³ç³»è¡¨

## ğŸ”Œ API æ¥å£ï¼ˆ21ä¸ªï¼‰

### ç”¨æˆ·ç¤¾äº¤ (6ä¸ª)
- âœ… POST `/api/community/follows`
- âœ… DELETE `/api/community/follows/:id`
- âœ… GET `/api/community/users/:id/following`
- âœ… GET `/api/community/users/:id/followers`
- âœ… POST `/api/community/blacklist`
- âœ… DELETE `/api/community/blacklist/:id`

### åˆ†ç±»æ ‡ç­¾ (2ä¸ª)
- âœ… GET `/api/community/categories/tree`
- âœ… GET `/api/community/tags`

### å†…å®¹äº’åŠ¨ (8ä¸ª)
- âœ… POST `/api/community/content`
- âœ… GET `/api/community/content`
- âœ… GET `/api/community/content/:id`
- âœ… POST `/api/community/content/:id/comments`
- âœ… POST `/api/community/content/:id/like`
- âœ… DELETE `/api/community/content/:id/like`
- âœ… POST `/api/community/content/:id/collect`
- âœ… DELETE `/api/community/content/:id/collect`

### ä¸¾æŠ¥ç®¡ç† (3ä¸ª)
- âœ… POST `/api/community/reports`
- âœ… GET `/api/admin/community/reports`
- âœ… POST `/api/admin/community/reports/:id/handle`

### é—®ç­” (2ä¸ª)
- âœ… POST `/api/community/questions/:id/best-answer`
- âœ… DELETE `/api/community/questions/:id/best-answer`

## âœ… éªŒè¯æ¸…å•

- [x] PostgreSQL é©±åŠ¨å®‰è£…
- [x] æ•°æ®åº“é…ç½®æ–‡ä»¶æ›´æ–°
- [x] æ‰€æœ‰æ§åˆ¶å™¨æ›´æ–°ä¸º PostgreSQL è¯­æ³•
- [x] æ•°æ®åº“å»ºè¡¨è„šæœ¬åˆ›å»º
- [x] ç¯å¢ƒå˜é‡é…ç½®
- [x] æ–‡æ¡£æ›´æ–°
- [x] æµ‹è¯•è„šæœ¬åˆ›å»º
- [x] ä»£ç è¯­æ³•æ£€æŸ¥é€šè¿‡

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. åˆå§‹åŒ–æ•°æ®åº“ï¼ˆå¦‚æœªåˆå§‹åŒ–ï¼‰
```bash
psql -h 82.157.154.143 -p 5432 -U agri_root -d agri -f database-schema-postgres.sql
```

### 2. æµ‹è¯•è¿æ¥
```bash
npm run test:db
```

### 3. å¯åŠ¨æœåŠ¡
```bash
npm run dev
```

### 4. æµ‹è¯• API
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3003/

# è·å–åˆ†ç±»æ ‘
curl http://localhost:3003/api/community/categories/tree
```

## ğŸ“š å‚è€ƒæ–‡æ¡£

### å¿«é€Ÿå…¥é—¨
- ğŸ“– [START-HERE.md](./START-HERE.md) - **ä»è¿™é‡Œå¼€å§‹ï¼**
- ğŸ“– [QUICK-START.md](./QUICK-START.md) - å¿«é€Ÿå¯åŠ¨æŒ‡å—

### é…ç½®æŒ‡å—
- ğŸ“– [CLOUD-DATABASE-SETUP.md](./CLOUD-DATABASE-SETUP.md) - äº‘æ•°æ®åº“é…ç½®
- ğŸ“– [POSTGRESQL-SETUP.md](./POSTGRESQL-SETUP.md) - PostgreSQL è®¾ç½®

### å¼€å‘æ–‡æ¡£
- ğŸ“– [API-TEST-EXAMPLES.md](./API-TEST-EXAMPLES.md) - API æµ‹è¯•ç¤ºä¾‹
- ğŸ“– [README.md](./README.md) - å®Œæ•´è¯´æ˜
- ğŸ“– [DEPENDENCIES.md](./DEPENDENCIES.md) - ä¾èµ–è¯´æ˜

### è¿ç§»æŒ‡å—
- ğŸ“– [POSTGRESQL-MIGRATION.md](./POSTGRESQL-MIGRATION.md) - MySQL è¿ç§»æŒ‡å—

## ğŸ’¡ é‡è¦æç¤º

### 1. JWT å¯†é’¥
âš ï¸ ç¡®ä¿ `.env` ä¸­çš„ `JWT_SECRET` ä¸è®¤è¯æœåŠ¡ä¿æŒä¸€è‡´ï¼

### 2. ç½‘ç»œè¿æ¥
âš ï¸ ä½¿ç”¨äº‘æ•°æ®åº“éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥

### 3. IP ç™½åå•
âš ï¸ ç¡®ä¿æ‚¨çš„ IP å·²åŠ å…¥äº‘æ•°æ®åº“ç™½åå•

### 4. ç”Ÿäº§ç¯å¢ƒ
âš ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®ä¿®æ”¹é»˜è®¤å¯†ç 

## ğŸ‰ å®ŒæˆçŠ¶æ€

```
âœ… æ•°æ®åº“é©±åŠ¨è¿ç§»å®Œæˆ
âœ… é…ç½®æ–‡ä»¶æ›´æ–°å®Œæˆ
âœ… ä»£ç é‡æ„å®Œæˆ
âœ… æ–‡æ¡£æ›´æ–°å®Œæˆ
âœ… æµ‹è¯•å·¥å…·åˆ›å»ºå®Œæˆ
âœ… äº‘æ•°æ®åº“é…ç½®å®Œæˆ

ğŸš€ é¡¹ç›®å·²å°±ç»ªï¼Œå¯ä»¥å¯åŠ¨ï¼
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ [START-HERE.md](./START-HERE.md) å¸¸è§é—®é¢˜
2. è¿è¡Œ `npm run test:db` è¯Šæ–­è¿æ¥
3. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—
4. å‚è€ƒç›¸å…³æ–‡æ¡£

---

**é…ç½®å®Œæˆæ—¶é—´**: 2025-11-07  
**æ•°æ®åº“ç±»å‹**: PostgreSQL (äº‘æ•°æ®åº“)  
**çŠ¶æ€**: âœ… å°±ç»ª
