## 目标
- 建立一套统一、可复用、可本地化的错误消息与处理体系，覆盖“网络/鉴权/资源/表单/业务”常见场景，提升前端反馈的清晰度与一致性。
- 将错误上报与用户提示解耦：接口层统一产出结构化错误对象；UI层按场景选择 Banner/Toast/空态、重试按钮等交互。

## 错误消息目录（中文范例）
- 网络类
  - network.offline: 网络不可用，请检查网络连接。
  - network.timeout: 请求超时，请稍后重试。
  - network.error: 服务繁忙，请稍后重试。（错误代码：{code}）
- 鉴权与权限
  - auth.required: 请先登录后再访问该页面。
  - auth.invalid_credentials: 手机号或密码错误。
  - auth.token_expired: 登录已过期，请重新登录。
  - auth.forbidden: 您没有权限执行该操作。
- 资源与页面
  - resource.not_found: 未找到相关资源或页面。
  - resource.deleted: 该数据已被删除或不可用。
- 表单校验
  - form.required: 请填写必填项：{field}。
  - form.invalid_format: {field}格式不正确。
  - form.range_error: {field}必须在{min}-{max}之间。
- 业务场景
  - cart.add_failed: 加入购物车失败。
  - order.create_failed: 创建订单失败。
  - order.pay_failed: 支付发起失败。
  - order.not_owned: 无权查看此订单。
  - address.load_failed: 加载地址失败。
  - address.save_failed: 保存地址失败。
  - community.comment_failed: 评论发布失败。
  - finance.apply_failed: 融资申请提交失败。
- 频控与未知
  - rate_limit: 操作过于频繁，请稍后重试。
  - unknown: 出现未知错误，请刷新后重试。

## 技术方案
- 统一错误对象
  - 在 `frontend/smart-main/api/http.ts` 的 `request` 中，将非 2xx 的响应转换为结构化 `AppError`：`{ code: string, httpStatus: number, message: string, detail?: any }`。
  - 状态码映射（示例）：401→auth.required/auth.token_expired；403→auth.forbidden；404→resource.not_found；408/超时→network.timeout；>=500→network.error。
- 错误消息映射
  - 新增 `frontend/smart-main/utils/errors.ts`：
    - `ERROR_MESSAGES: Record<string, string>` 键值对；
    - `formatMessage(key, params)` 用于插值；
    - `fromHttp(status, payload)` 将接口返回的 `code/message` 映射为前端消息键。
- UI 组件与交互
  - 新增 `ErrorBanner`（页级）与 `InlineError`（区块级）：展示文案、支持“重试/返回”按钮；统一视觉。
  - 新增 `ErrorBoundary`（捕获渲染错误）：包裹 `App.tsx` 的 `Suspense`，提供“刷新页面/返回首页”。
  - Toast：沿用现有 Tailwind 风格快速实现轻量提示（操作成功/失败）。
- 页面接入点
  - `Auth.tsx`：登录失败显示 `auth.invalid_credentials`；token 过期跳转登录并提示 `auth.token_expired`。
  - `Mall.tsx`：商品列表加载失败显示 `network.error` 与“重试”。
  - `Cart.tsx`：数量更新/删除失败分别显示 `cart.add_failed`、`network.error`。
  - `Checkout.tsx`：订单创建/支付失败显示 `order.create_failed` / `order.pay_failed`，保留重试。
  - `BuyerAddress.tsx`：加载/保存/设默认失败分别显示对应消息；输入校验提示表单类消息。
  - `BuyerOrders.tsx`：列表失败显示 `network.error`；空态提示“暂无订单”。
  - `BuyerOrderDetail.tsx`：详情失败显示 `resource.not_found` 或 `order.not_owned`。
  - 布局 `DashboardLayout`：无 token 时跳转登录，显示 `auth.required`。

## 实施步骤
1. 新增 `utils/errors.ts`（消息表与工具函数）。
2. 扩展 `api/http.ts`：统一捕获错误，产出 `AppError` 并映射消息键（不在控制台打印敏感信息）。
3. 新增 UI 组件：`components/ErrorBanner.tsx`、`components/ErrorBoundary.tsx`、`components/Toast.tsx`。
4. 在 `App.tsx` 中用 `ErrorBoundary` 包裹路由与 `Suspense`。
5. 在上述页面接入错误显示与重试逻辑（保留现有 mock 回退以保障可见性）。
6. 编写简单测试场景：
   - 断网/超时（修改 base 或暂时关闭服务）验证网络类消息；
   - 登录失败验证鉴权消息；
   - 请求不存在的订单验证 404 映射与空态。

## 文案与体验规范
- 简明、可行动：一句话描述+可选动作（重试、返回）。
- 不暴露内部细节：隐藏堆栈与敏感信息；Debug 仅在开发模式下到控制台。
- 一致风格：颜色/布局统一（错误红、警告橙、信息蓝、成功绿）。
- 可本地化：消息键支持未来多语言扩展。

如确认以上方案，我将开始落地实现（新增工具与组件、扩展 http.ts 并逐页接入），并自测验证各类错误提示与重试交互。