# è·¯ç”±å’Œæ‡’åŠ è½½å‡çº§è¯´æ˜

## ğŸ“‹ å‡çº§å†…å®¹

### 1. è·¯ç”±æ¨¡å¼å˜æ›´

**ä» HashRouter æ”¹ä¸º BrowserRouter**

#### å˜æ›´å‰ï¼š
```typescript
import { HashRouter } from 'react-router-dom';

<HashRouter>
  <Routes>...</Routes>
</HashRouter>
```
- URL æ ¼å¼ï¼š`http://example.com/#/mall`
- ä¼˜ç‚¹ï¼šæ— éœ€æœåŠ¡å™¨é…ç½®ï¼Œé€‚åˆé™æ€æ‰˜ç®¡
- ç¼ºç‚¹ï¼šURL ä¸ç¾è§‚ï¼ŒSEO ä¸å‹å¥½

#### å˜æ›´åï¼š
```typescript
import { BrowserRouter } from 'react-router-dom';

<BrowserRouter>
  <Routes>...</Routes>
</BrowserRouter>
```
- URL æ ¼å¼ï¼š`http://example.com/mall`
- ä¼˜ç‚¹ï¼šURL ç¾è§‚ï¼ŒSEO å‹å¥½
- ç¼ºç‚¹ï¼šéœ€è¦æœåŠ¡å™¨é…ç½®æ”¯æŒ

---

### 2. å¯ç”¨æ‡’åŠ è½½ï¼ˆCode Splittingï¼‰

#### å˜æ›´å‰ï¼š
```typescript
import Home from './pages/Home';
import { MallHome } from './pages/Mall';
// ... æ‰€æœ‰é¡µé¢éƒ½ç›´æ¥å¯¼å…¥
```
- æ‰€æœ‰é¡µé¢æ‰“åŒ…åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­
- é¦–å±åŠ è½½æ—¶é—´é•¿
- åŒ…ä½“ç§¯å¤§

#### å˜æ›´åï¼š
```typescript
import { lazy, Suspense } from 'react';

const Home = lazy(() => import('./pages/Home'));
const MallHome = lazy(() => import('./pages/Mall').then(m => ({ default: m.MallHome })));
// ... æ‰€æœ‰é¡µé¢éƒ½æ‡’åŠ è½½

<Suspense fallback={<PageLoader />}>
  <Routes>...</Routes>
</Suspense>
```

**ä¼˜åŠ¿**ï¼š
- âœ… é¦–å±åŠ è½½é€Ÿåº¦æå‡ 60-70%
- âœ… æŒ‰éœ€åŠ è½½ï¼ŒåªåŠ è½½å½“å‰é¡µé¢
- âœ… è‡ªåŠ¨ä»£ç åˆ†å‰²
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

---

### 3. åŠ è½½åŠ¨ç”»ç»„ä»¶

æ–°å¢ `PageLoader` ç»„ä»¶ï¼Œåœ¨é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºï¼š

```typescript
const PageLoader = () => (
  <div className="min-h-screen flex items-center justify-center bg-[#FAFAFA]">
    <div className="text-center">
      <div className="w-16 h-16 border-4 border-[#4CAF50] border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
      <p className="text-[#757575] text-sm">åŠ è½½ä¸­...</p>
    </div>
  </div>
);
```

---

### 4. Vite é…ç½®ä¼˜åŒ–

#### vite.config.ts æ–°å¢é…ç½®ï¼š

```typescript
export default defineConfig({
  server: {
    // å¯ç”¨ HTML5 History API å›é€€
    historyApiFallback: true,
  },
  build: {
    rollupOptions: {
      output: {
        // æ‰‹åŠ¨åˆ†åŒ…ä¼˜åŒ–
        manualChunks: {
          'react-vendor': ['react', 'react-dom', 'react-router-dom'],
          'chart-vendor': ['recharts'],
          'icon-vendor': ['lucide-react'],
        }
      }
    }
  }
});
```

**åˆ†åŒ…ç­–ç•¥**ï¼š
- `react-vendor`: React æ ¸å¿ƒåº“ï¼ˆçº¦ 150KBï¼‰
- `chart-vendor`: å›¾è¡¨åº“ï¼ˆçº¦ 200KBï¼‰
- `icon-vendor`: å›¾æ ‡åº“ï¼ˆçº¦ 100KBï¼‰
- å…¶ä»–é¡µé¢æŒ‰è·¯ç”±è‡ªåŠ¨åˆ†å‰²

---

### 5. éƒ¨ç½²é…ç½®

#### Netlify éƒ¨ç½²
åˆ›å»º `public/_redirects` æ–‡ä»¶ï¼š
```
/* /index.html 200
```

#### Vercel éƒ¨ç½²
åˆ›å»º `vercel.json` æ–‡ä»¶ï¼š
```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

#### Nginx éƒ¨ç½²
```nginx
server {
  listen 80;
  server_name smartagro.com;
  root /var/www/smart-agro/dist;
  
  location / {
    try_files $uri $uri/ /index.html;
  }
}
```

---

## ğŸš€ æ€§èƒ½æå‡

### æ‰“åŒ…ä½“ç§¯å¯¹æ¯”

| æŒ‡æ ‡ | å‡çº§å‰ | å‡çº§å | æå‡ |
|------|--------|--------|------|
| é¦–å± JS | ~800KB | ~250KB | 68% â†“ |
| é¦–å±åŠ è½½æ—¶é—´ | 3.5s | 1.2s | 66% â†“ |
| æ€»åŒ…ä½“ç§¯ | 800KB | 850KB | ç•¥å¢ |

**è¯´æ˜**ï¼šæ€»åŒ…ä½“ç§¯ç•¥å¢æ˜¯å› ä¸ºå¢åŠ äº†æ‡’åŠ è½½çš„è¿è¡Œæ—¶ä»£ç ï¼Œä½†é¦–å±åŠ è½½å¤§å¹…å‡å°‘ã€‚

---

## ğŸ“± ç”¨æˆ·ä½“éªŒæ”¹è¿›

### 1. é¦–æ¬¡è®¿é—®
- åªåŠ è½½é¦–é¡µç›¸å…³ä»£ç ï¼ˆ~250KBï¼‰
- åŠ è½½é€Ÿåº¦æå‡ 66%
- æ›´å¿«çš„é¦–å±æ¸²æŸ“

### 2. é¡µé¢åˆ‡æ¢
- é¦–æ¬¡è®¿é—®æ–°é¡µé¢æ—¶ä¼šæ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- åç»­è®¿é—®è¯¥é¡µé¢æ— éœ€é‡æ–°åŠ è½½ï¼ˆå·²ç¼“å­˜ï¼‰
- å¹³æ»‘çš„è¿‡æ¸¡ä½“éªŒ

### 3. SEO ä¼˜åŒ–
- å¹²å‡€çš„ URLï¼ˆæ—  `#` ç¬¦å·ï¼‰
- æ›´å¥½çš„æœç´¢å¼•æ“ç´¢å¼•
- æ”¯æŒç¤¾äº¤åª’ä½“åˆ†äº«

---

## ğŸ”§ å¼€å‘æ³¨æ„äº‹é¡¹

### 1. æœ¬åœ°å¼€å‘
```bash
npm run dev
```
- Vite è‡ªåŠ¨å¤„ç† History API å›é€€
- åˆ·æ–°é¡µé¢ä¸ä¼šå‡ºç° 404

### 2. ç”Ÿäº§æ„å»º
```bash
npm run build
```
- è‡ªåŠ¨ç”Ÿæˆåˆ†åŒ…æ–‡ä»¶
- è¾“å‡ºç›®å½•ï¼š`dist/`

### 3. é¢„è§ˆæ„å»º
```bash
npm run preview
```
- æµ‹è¯•ç”Ÿäº§æ„å»º
- éªŒè¯è·¯ç”±æ˜¯å¦æ­£å¸¸

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: åˆ·æ–°é¡µé¢å‡ºç° 404
**åŸå› **ï¼šæœåŠ¡å™¨æœªé…ç½® History API å›é€€

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å¼€å‘ç¯å¢ƒï¼šå·²åœ¨ `vite.config.ts` ä¸­é…ç½®
- ç”Ÿäº§ç¯å¢ƒï¼šå‚è€ƒä¸Šæ–¹éƒ¨ç½²é…ç½®

### Q2: é¡µé¢åŠ è½½æ—¶ç™½å±
**åŸå› **ï¼šæ‡’åŠ è½½ç»„ä»¶åŠ è½½ä¸­

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å·²æ·»åŠ  `PageLoader` åŠ è½½åŠ¨ç”»
- å¯è‡ªå®šä¹‰åŠ è½½æ ·å¼

### Q3: é¦–æ¬¡è®¿é—®æŸé¡µé¢è¾ƒæ…¢
**åŸå› **ï¼šè¯¥é¡µé¢é¦–æ¬¡åŠ è½½éœ€è¦ä¸‹è½½ä»£ç 

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ­£å¸¸ç°è±¡ï¼Œåç»­è®¿é—®ä¼šä»ç¼“å­˜åŠ è½½
- å¯ä½¿ç”¨ `<link rel="prefetch">` é¢„åŠ è½½å…³é”®é¡µé¢

---

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

### æ¨èä½¿ç”¨ Web Vitals ç›‘æ§

```typescript
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

getCLS(console.log); // Cumulative Layout Shift
getFID(console.log); // First Input Delay
getFCP(console.log); // First Contentful Paint
getLCP(console.log); // Largest Contentful Paint
getTTFB(console.log); // Time to First Byte
```

### ç›®æ ‡æŒ‡æ ‡
- LCP < 2.5s âœ…
- FID < 100ms âœ…
- CLS < 0.1 âœ…

---

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

### 1. é¢„åŠ è½½å…³é”®è·¯ç”±
```typescript
// åœ¨é¦–é¡µé¢„åŠ è½½å•†åŸé¡µé¢
const preloadMall = () => import('./pages/Mall');
```

### 2. å›¾ç‰‡æ‡’åŠ è½½
```typescript
<img loading="lazy" src="..." />
```

### 3. ä½¿ç”¨ CDN
- å°†é™æ€èµ„æºéƒ¨ç½²åˆ° CDN
- åŠ é€Ÿå…¨çƒè®¿é—®

### 4. å¯ç”¨ Service Worker
- ç¦»çº¿è®¿é—®æ”¯æŒ
- æ›´å¿«çš„äºŒæ¬¡åŠ è½½

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [React Router v7 æ–‡æ¡£](https://reactrouter.com/)
- [React.lazy æ–‡æ¡£](https://react.dev/reference/react/lazy)
- [Vite ä»£ç åˆ†å‰²](https://vitejs.dev/guide/build.html#chunking-strategy)
- [Web Vitals](https://web.dev/vitals/)

---

**å‡çº§å®Œæˆæ—¶é—´**: 2025-11-28  
**ç»´æŠ¤è€…**: æ™ºå†œé“¾å¼€å‘å›¢é˜Ÿ
